### Inhoudsopgave
* [1. Inleiding](1.%20Inleiding.md)
* [2. Concepten](2.%20Concepten.md)
* [3. Systeem architectuur](3.%20Systeem%20architectuur.md)
* [4. Data model](4.%20Data%20model.md)
* [5. Security & privacy](#5-security--privacy)
  * [5.1 Client-side encryptie](#51-client-side-encryptie)
  * [5.2 At-rest encryptie](#52-at-rest-encryptie)
  * [5.3 Hashing](#53-hashing)
  * [5.4 RPC bridge](#54-rpc-bridge)
  * [5.5 Authenticatie en autorisatie](#55-authenticatie-en-autorisatie)
  * [5.5 Overig](#55-overig)
* [6. Infrastructuur](6.%20Infrastructuur.md)

# 5. Security & privacy
In dit hoofdstuk worden de maatregelen die zijn getroffen in het kader van security & privacy beschreven.

## 5.1 Client-side encryptie
Omdat er met persoonsgegevens wordt gewerkt in het burgerportaal is er besloten om bovenop de HTTP TLS encryptie 
gebruik te maken van client-side encryptie. Dit wordt zowel toegepast bij het versturen van data richting de 
server als bij het opvragen van data.

Schematisch ziet het versturen van data naar de server er als volgt uit:
![Client-side encryptie bij versturen data](images/versleuteling-client-server.svg)

Schematisch ziet het ontvangen van (mogelijk gevoelige) data van de server er als volgt uit:
![Client-side encryptie bij ontvangen data](images/versleuteling-server-client.svg)

Voor de encryptie wordt er gebruik gemaakt van [Sodium](https://doc.libsodium.org). In de browser wordt gebruik
gemaakt van [libsodium.js](https://github.com/jedisct1/libsodium.js/); een versie van Sodium die
naar webassembly is compileerd. Voor PHP wordt de libsodium [PECL extensie](https://pecl.php.net/package/libsodium) 
gebruikt.

## 5.2 At-rest encryptie
Alle formulier antwoorden, zowel uit het burger als behandel portaal, worden versleuteld in de database opgeslagen. 
Ook eventuele file uploads worden versleuteld voor ze naar de file storage worden weggeschreven.

Elke keer als er antwoorden worden ingestuurd wordt er een nieuwe sleutel gegenereerd. Deze sleutel wordt met
de publieke sleutel uit een **HSM** (Hardware Security Module) versleuteld opgeslagen in de database. Vervolgens worden
alle antwoorden met deze sleutel versleuteld. 

Op het moment dat de antwoorden worden opgevraagd wordt de versleutelde sleutel via de HSM weer leesbaar gemaakt. En
kunnen de antwoorden worden ontsleuteld.

## 5.3 Hashing
_TODO_

## 5.4 RPC bridge
_TODO_

## 5.5 Authenticatie en autorisatie
_TODO incl. 2FA_ 

## 5.5 Overig
_TODO_