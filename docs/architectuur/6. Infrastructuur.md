# 6. Infrastructuur

Onderstaande figuur toont de infrastructurele architectuur voor het DUS-I project:

![Infrastructuur](./images/infrastructuur.svg)

## 6.1 Functionele beschrijving

Het DUS-I project kent een legacy applicatie (in WordPress), en een nieuwbouw applicatie in PHP die wordt ontwikkeld
door iRealisatie. De nieuwbouw applicatie biedt vier toegangen:

* het aanvraagportaal
* het beoordelingportaal
* het formulierportaal
* het gebruikersbeheerportaal

## 6.2 Technische beschrijving

De portalen en de legacy applicatie zijn gekoppeld aan het internet middels RC10/RC20 servers. Naast servers voor de
Wordpress applicatie en de vier portalen wordt er ook een max server aangeroepen welke de DigID aanvragen behandeld.
Dit zijn front-end servers.

Via onze **gateway (FW set)** worden twee loadbalancers px11 en px12 (HA-proxy) bevraagd die een serie servers kan
aanroepen (worden bijgeschakeld naar behoefte). Het Nationaal Detectie Network (**NDN**) houd het internet verkeer aan
de buitenkant in de gaten.

Tussen de loadbalancers en de servers bevind zich een **firewall**.

De Front-end servers kunnen via de tweede set loadbalancers **px21** en **px222** (HA-proxy) de backend servers
benaderen. Hier zien we een serie servers (worden bijgeschakeld naar behoefte) die het volgende huisvesten:

* Harrie12 – wordt gebruikt voor bevraging BRP (nog niet in gebruik)
* Mariadb – MySQL database servers, specifiek voor de WordPress installatie
* Postgres – PostgreSQL database servers, specifiek voor de iRealisatie portaal installatie
* Backend – Servers voor de ophalen, verwerken en opslaan van gegevens.
* Keydb – Caching systeem voor key/value pairs
* Rabbit – Message queue servers voor de communicatie tussen front-end en back-end
* HSM controller – Hardware Security Module controllers.
* Files – Servers voor opslag van (tijdelijke) bestanden.

De HSM controllers hebben toegang tot de twee HSM servers (**hsm1** en **hsm2**). Op deze HSM servers heeft Justid
management toegang.

## 6.3 Deployment en monitoring

**VPN** is een virtual private network tunnel die door de afdeling Operations van iRealisatie gebruikt wordt om het
datacenter netwerk bij Prolocation te benaderen.  Vandaar is er toegang tot de **log**server waar alle hosts hun syslog
gegevens heen sturen. Die **logs** host wordt door Prolocation beheerd. Wij hebben enkel leestoegang hebben tot de log
gegevens.

## 6.4 Tertiaire backup (Delft)

Dagelijks wordt er een backup gemaakt van alle schijven van alle Virtual Machines (vm). Deze backup wordt
opgeslagen in Delft.
