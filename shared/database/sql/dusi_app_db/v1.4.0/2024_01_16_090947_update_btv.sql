update "subsidies"
set reference_prefix = 'BTV'
where id = '00f26400-7232-475f-922c-6b569b7e421a';

update "subsidy_stages"
set title = 'Interne Controle'
where id = 'e456e790-1919-4a2b-b3d5-337d0053abe3';

delete
from answers
where field_id = (select id
                    from fields
                    where code = 'bankStatement' and subsidy_stage_id = '721c1c28-e674-415f-b1c3-872a631ed045');

delete from fields where code = 'bankStatement' and subsidy_stage_id = '721c1c28-e674-415f-b1c3-872a631ed045';

delete
from answers
where field_id = (select id
                    from fields
                    where code = 'permissionToProcessPersonalData' and subsidy_stage_id = '721c1c28-e674-415f-b1c3-872a631ed045');

delete from fields where code = 'permissionToProcessPersonalData' and subsidy_stage_id = '721c1c28-e674-415f-b1c3-872a631ed045';

update "fields"
set params = '{"options":["Uittreksel van het BRP is opgestuurd","De aanvrager is een ingezetene (> 4 maanden) in Nederland","de aanvrager is ouder dan 18 jaar","De verklaring van de arts over het behandeltraject is opgestuurd","De verklaring van de arts over het behandeltraject is minder dan 2 maanden oud","De verklaring van de arts over het behandeltraject is ondertekend en voorzien van een naamstempel","Het opgegeven BIG-nummer komt overeen met het BIG-register","De operatie heeft nog niet plaatsgevonden","De aanvrager heeft genderdysforie","De aanvrager heeft minimaal een jaar voor de aanvraag hormoonbehandeling ondergaan, of is hiermee vanwege medische redenen gestopt of kon deze om medische redenen niet ondergaan","De verklaring van de arts met de vermelding van de type behandeling is opgestuurd","De verklaring van de arts met de vermelding van de type behandeling is ondertekend en voorzien van een naamstempel","De type behandeling voldoet aan de voorwaarden conform de subsidieregeling"]}'
where code = 'firstAssessmentChecklist'
  and subsidy_stage_id = '6bcd59ab-2ba6-43bb-a1a1-9fb995f0e59c';

update "fields"
set params = '{"options":["Oneens met de eerste beoordeling","Eens met de eerste beoordeling"],"default":null}'
where code = 'secondAssessment'
  and subsidy_stage_id = 'b2b08566-8493-4560-8afa-d56402931f74';

insert into "subsidy_stage_hashes" ("id", "subsidy_stage_id", "name", "description", "created_at", "updated_at")
values ('70609201-1301-455c-942b-654236221970', '721c1c28-e674-415f-b1c3-872a631ed045', 'Bank account',
        'Bank account duplicate reporting', 'now()', 'now()');

insert into "subsidy_stage_hash_fields" ("subsidy_stage_hash_id", "field_id")
values ('70609201-1301-455c-942b-654236221970', (select id
        from "fields"
        where "subsidy_stage_id" = '721c1c28-e674-415f-b1c3-872a631ed045'
        and "code" = 'bankAccountNumber'
        and "title" = 'IBAN' limit 1)
);

UPDATE fields
SET params = '{"maxItems": 20, "minItems": 1, "mimeTypes": ["image/jpeg", "image/png", "application/pdf"], "maxFileSize": 20971520}'
WHERE code = 'extractPopulationRegisterDocument'
  AND subsidy_stage_id = '721c1c28-e674-415f-b1c3-872a631ed045';

UPDATE fields
SET params = '{"maxItems": 20, "minItems": 1, "mimeTypes": ["image/jpeg", "image/png", "application/pdf"], "maxFileSize": 20971520}'
WHERE code = 'proofOfMedicalTreatmentDocument'
  AND subsidy_stage_id = '721c1c28-e674-415f-b1c3-872a631ed045';

UPDATE fields
SET params = '{"maxItems": 20, "minItems": 1, "mimeTypes": ["image/jpeg", "image/png", "application/pdf"], "maxFileSize": 20971520}'
WHERE code = 'proofOfTypeOfMedicalTreatmentDocument'
  AND subsidy_stage_id = '721c1c28-e674-415f-b1c3-872a631ed045';

update "subsidy_stage_uis"
set input_ui = '{"type":"CustomPageNavigationControl","elements":[{"type":"CustomPageControl","label":"start","elements":[{"type":"FormGroupControl","options":{"section":true},"elements":[{"type":"FormHtml","options":{"html":"<p class=\"warning\">\n    <span>Waarschuwing:<\/span>\n    Het invullen van een aanvraag kost ongeveer 10 minuten. U kunt uw aanvraag tussentijds opslaan. Zorg ervoor dat u\n    alle gevraagde documenten digitaal bij de hand heeft. Dit kan bijvoorbeeld een scan, schermafdruk of foto vanaf uw\n    mobiele telefoon zijn. Laat uw aanvraag niet langer dan noodzakelijk open staan op uw computer.\n<\/p>\n\n<h2>Introductie<\/h2>\n<p>\n    Bent u een transvrouw met genderdysforie? En bevindt u zich in een medisch transitietraject en\n    overweegt u een borstvergroting? U kunt dan in aanmerking komen voor een subsidie via de\n    subsidieregeling Borstprothesen transvrouwen. Met dit formulier vraagt u een subsidie aan voor een\n    plastisch-chirurgische borstconstructie. Deze behandeling moet bewezen effectief zijn.\n<\/p>\n<h2>Benodigde bestanden<\/h2>\n<p>Om in aanmerking te komen voor de subsidie, worden een aantal documenten aan u gevraagd:<\/p>\n<p><\/p>\n<ol>\n    <li>Uittreksel Basisregistratie Personen;<\/li>\n    <li>\n        Medische verklaring van uw BIG-geregistreerde arts over de behandeling die u tot nu toe heeft\n        gevolgd. Download het\n        <a\n            title=\"Medische verklaring behandeltraject format\"\n            href=\"https:\/\/www.dus-i.nl\/subsidies\/borstprothesen-transvrouwen\/documenten\/publicaties\/2019\/01\/14\/verklaring-behandelend-arts-borstprothesen-transvrouwen\"\n            target=\"_blank\"\n            rel=\"nofollow noopener external\"\n        >Medische verklaring behandeltraject format<\/a\n        >.\n    <\/li>\n    <li>\n        Medische verklaring van een BIG-geregistreerde arts over de behandeling (operatie) die zal\n        worden uitgevoerd. Download het\n        <a\n            title=\"Medische verklaring van het type behandeling format\"\n            href=\"https:\/\/www.dus-i.nl\/subsidies\/borstprothesen-transvrouwen\/documenten\/publicaties\/2021\/08\/05\/medische-verklaring-van-het-type-behandeling-borstprothesen-transvrouwen\"\n            target=\"_blank\"\n            rel=\"nofollow noopener external\"\n        >Medische verklaring van het type behandeling format<\/a\n        >.\n    <\/li>\n<\/ol>\n<p>In de derde stap van het aanvraagformulier kunt u deze uploaden.<\/p>\n<p>Laat uw aanvraag niet langer dan noodzakelijk open staan op uw computer.<\/p>\n<h2>Aanvraag starten<\/h2>\n"}}]}],"options":{"required":[],"allOf":[]}},{"type":"CustomPageControl","label":"Persoonsgegevens toevoegen","elements":[{"type":"FormGroupControl","options":{"section":true},"elements":[{"type":"Group","elements":[{"type":"FormNotification","options":{"displayAs":"explanation","message":"U moet ouder zijn dan 18 jaar (artikel 4 van de regeling)."}}]},{"type":"Group","label":"Persoonlijke informatie","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/firstName","label":"Voornaam","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/infix","label":"Tussenvoegsel","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/lastName","label":"Achternaam","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/dateOfBirth","label":"Geboortedatum","options":{"placeholder":""}}]}]},{"type":"Group","label":"Adres","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/street","label":"Straatnaam","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/houseNumber","label":"Huisnummer","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/houseNumberSuffix","label":"Huisnummer toevoeging","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/postalCode","label":"Postcode","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/city","label":"Plaatsnaam","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/country","label":"Land","options":{"format":"select","placeholder":"Selecteer een land"}}]}]},{"type":"Group","label":"Contact","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/phoneNumber","label":"Telefoonnummer","options":{"placeholder":""}},{"type":"CustomControl","scope":"#\/properties\/email","label":"E-mailadres","options":{"placeholder":"","tip":"U wordt via dit e-mailadres ge\u00efnformeerd over de status van uw aanvraag. Geef daarom alleen uw eigen e-mailadres door.","validation":["onBlur"]}}]}]},{"type":"Group","label":"Bank","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/bankAccountHolder","label":"Naam rekeninghouder","options":{"placeholder":"","validation":["onBlur"]}},{"type":"CustomControl","scope":"#\/properties\/bankAccountNumber","label":"IBAN","options":{"placeholder":"","tip":"Staat u onder bewind? Vermeld dan het IBAN van uw beheerrekening.","validation":["onValid"]}}]}]}]}],"options":{"required":["firstName","lastName","street","dateOfBirth","houseNumber","postalCode","city","country","phoneNumber","email","bankAccountHolder","bankAccountNumber"],"allOf":[]}},{"type":"CustomPageControl","label":"Documenten toevoegen","elements":[{"type":"FormGroupControl","options":{"section":true},"elements":[{"type":"Group","label":"Uw bankgegevens","elements":[{"type":"VerticalLayout","elements":[{"type":"FormResultsTable","label":"Uw bankgegegvens","options":{"fields":{"Naam rekeninghouder":"{bankAccountHolder}","IBAN":"{bankAccountNumber}"}}}]}]},{"type":"Group","label":"Uittreksel bevolkingsregister","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/extractPopulationRegisterDocument","label":"Uittreksel bevolkingsregister","options":{"accept":"image\/jpeg,image\/png,.pdf","maxFileSize":20971520,"minItems":1,"maxItems":20,"tip":"U kunt een uittreksel uit het bevolkingsregister (de Basisregistratie personen) opvragen bij de gemeente waar u staat ingeschreven. Dit document bevat uw naam, geboortedatum en adres. Toegestane bestandstypen: pdf, jpg, jpeg, png, Maximale bestandsgrootte: 20 MB."}}]}]},{"type":"Group","label":"Medische verklaring behandeltraject","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/proofOfMedicalTreatmentDocument","label":"Verklaring behandeltraject","options":{"accept":"image\/jpeg,image\/png,.pdf","maxFileSize":20971520,"minItems":1,"maxItems":20,"tip":"De <a title=\"medische verklaring over het behandeltraject\" href=\"#\" target=\"_blank\" rel=\"noopener\" class=\"external\">medische verklaring over het behandeltraject<\/a> dat u tot nu toe heeft gevolgd moet zijn ingevuld door de BIG-geregistreerde arts waar u in behandeling bent. Dit kan een huisarts of medisch specialist zijn die de hormonen voorschrijft en de behandeling begeleidt. De verklaring mag niet ouder zijn dan twee maanden. Toegestane bestandstypen: pdf, jpg, jpeg, png, Maximale bestandsgrootte: 20 MB."}}]}]},{"type":"Group","label":"Medische verklaring van het type behandeling","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/proofOfTypeOfMedicalTreatmentDocument","label":"Verklaring type behandeling","options":{"accept":"image\/jpeg,image\/png,.pdf","maxFileSize":20971520,"minItems":1,"maxItems":20,"tip":"De <a title=\"medische verklaring van het type behandeling\" href=\"#\" target=\"_blank\" rel=\"noopener\" class=\"external\">medische verklaring van het type behandeling<\/a> (operatie) dat zal worden uitgevoerd moet zijn ingevuld en ondertekend door een BIG-geregistreerde arts. Toegestane bestandstypen: pdf, jpg, jpeg, png, Maximale bestandsgrootte: 20 MB."}}]}]}]}],"options":{"required":["extractPopulationRegisterDocument","proofOfMedicalTreatmentDocument","proofOfTypeOfMedicalTreatmentDocument"],"allOf":[]}},{"type":"CustomPageControl","label":"Controleren en ondertekenen","elements":[{"type":"FormGroupControl","options":{"section":true},"elements":[{"type":"Group","label":"Controleren","elements":[{"type":"FormResultsTable","label":"Uw gegevens","options":{"fields":{"Naam":"{firstName} {infix} {lastName}","Adres":"{street} {houseNumber}{houseNumberSuffix} {postalCode} {city}","Telefoon":"{phoneNumber}","E-mailadres":"{email}","Geboortedatum":"{dateOfBirth}"}}}]},{"type":"Group","label":"Ondertekenen","elements":[{"type":"CustomControl","scope":"#\/properties\/truthfullyCompleted","label":"Inhoud","options":{"description":"Ik verklaar het formulier naar waarheid te hebben ingevuld."}}]}]}],"options":{"required":["truthfullyCompleted"],"allOf":[]}}]}',
    view_ui  = '{"type":"FormGroupControl","options":{"section":true},"elements":[{"type":"FormGroupControl","label":"Persoonlijke informatie","options":{"section":true,"headingLevel":"2"},"elements":[{"type":"FormResultsTable","options":{"fields":{"Voornaam":"{firstName}","Tussenvoegsel":"{infix}","Achternaam":"{lastName}","Geboortedatum":"{dateOfBirth}"}}}]},{"type":"FormGroupControl","label":"Adres","options":{"section":true,"headingLevel":"2"},"elements":[{"type":"FormResultsTable","options":{"fields":{"Land":"{country}","Straatnaam":"{street}","Huisnummer":"{houseNumber}","Huisnummer toevoeging":"{houseNumberSuffix}","Postcode":"{postalCode}","Plaatsnaam":"{city}"}}}]},{"type":"FormGroupControl","label":"Contact","options":{"section":true,"headingLevel":"2"},"elements":[{"type":"FormResultsTable","options":{"fields":{"Telefoonnummer":"{phoneNumber}","E-mailadres":"{email}"}}}]},{"type":"FormGroupControl","label":"Bank","options":{"section":true,"headingLevel":"2"},"elements":[{"type":"FormResultsTable","options":{"fields":{"IBAN":"{bankAccountNumber}","Naam rekeninghouder":"{bankAccountHolder}"}}}]},{"type":"FormGroupControl","label":"Bestanden","options":{"section":true,"headingLevel":"2"},"elements":[{"type":"FormResultsTable","options":{"fields":{"Uitreksel bevolkingsregister":"{extractPopulationRegisterDocument}","Verklaring behandeltraject":"{proofOfMedicalTreatmentDocument}","Verklaring type behandeling":"{proofOfTypeOfMedicalTreatmentDocument}"}}}]}]}'
where id = '72475863-7987-4375-94d7-21e04ff6552b';

update "subsidy_stage_uis"
set input_ui = '{"type":"FormGroupControl","options":{"section":true,"group":true},"elements":[{"type":"Group","label":"Beoordeling","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessmentChecklist","options":{"format":"checkbox-group"}}]}]},{"type":"Group","label":"Uitkering","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/amount","options":{"format":"radio"}}]}]},{"type":"Group","label":"Status","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessment","options":{"format":"radio"}}]}]},{"type":"Group","label":"Toelichting","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessmentRequestedComplementReason","options":{"format":"radio"},"rule":{"effect":"SHOW","condition":{"scope":"#\/properties\/firstAssessment","schema":{"const":"Aanvulling nodig"}}}}]},{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessmentRequestedComplementNote","options":{"format":"textarea","tip":"Deze notitie wordt opgenomen binnen de brief aan de aanvrager."},"rule":{"effect":"SHOW","condition":{"scope":"#\/properties\/firstAssessment","schema":{"const":"Aanvulling nodig"}}}}]},{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessmentRejectedNote","options":{"format":"textarea","tip":"Deze notitie wordt opgenomen binnen de brief aan de aanvrager."},"rule":{"effect":"SHOW","condition":{"scope":"#\/properties\/firstAssessment","schema":{"const":"Afgekeurd"}}}}]},{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessmentInternalNote","options":{"format":"textarea"}}]}]}]}',
    view_ui  = '{"type":"FormGroupControl","options":{"section":true},"elements":[{"type":"FormGroupControl","label":"Persoonsgegevens","options":{"section":true,"headingLevel":"2"},"elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessmentChecklist","options":{"readonly":true,"format":"checkbox-group"}}]},{"type":"FormGroupControl","label":"Uitkering","options":{"section":true,"headingLevel":"2"},"elements":[{"type":"CustomControl","scope":"#\/properties\/amount","options":{"readonly":true}}]},{"type":"FormGroupControl","label":"Eerste beoordeling","options":{"section":true,"headingLevel":"2"},"elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessment","options":{"readonly":true,"format":"radio"}},{"type":"CustomControl","scope":"#\/properties\/firstAssessmentRequestedComplementReason","options":{"readonly":true,"format":"radio"},"rule":{"effect":"SHOW","condition":{"scope":"#\/properties\/firstAssessment","schema":{"const":"Aanvulling nodig"}}}},{"type":"CustomControl","scope":"#\/properties\/firstAssessmentRequestedComplementNote","options":{"readonly":true,"format":"textarea"},"rule":{"effect":"SHOW","condition":{"scope":"#\/properties\/firstAssessment","schema":{"const":"Aanvulling nodig"}}}},{"type":"CustomControl","scope":"#\/properties\/firstAssessmentRejectedNote","options":{"readonly":true,"format":"textarea"},"rule":{"effect":"SHOW","condition":{"scope":"#\/properties\/firstAssessment","schema":{"const":"Afgekeurd"}}}},{"type":"CustomControl","scope":"#\/properties\/firstAssessmentInternalNote","options":{"readonly":true,"format":"textarea"}}]}]}'
where id = 'f4e7f866-5750-45a5-b613-4d0a202676e4';

update "subsidy_stage_uis"
set input_ui = '{"type":"FormGroupControl","options":{"section":true,"group":true},"elements":[{"type":"Group","label":"Status","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessorMotivatedValid","options":{"format":"checkbox"}}]},{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/secondAssessment","options":{"format":"radio"}}]},{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/secondAssessmentInternalNote","options":{"format":"textarea"}}]}]}]}',
    view_ui  = '{"type":"FormGroupControl","options":{"section":true},"elements":[{"type":"CustomControl","scope":"#\/properties\/firstAssessorMotivatedValid","options":{"readonly":true}},{"type":"CustomControl","scope":"#\/properties\/secondAssessment","options":{"readonly":true,"format":"radio"}},{"type":"CustomControl","scope":"#\/properties\/secondAssessmentInternalNote","options":{"readonly":true,"format":"textarea"}}]}'
where id = 'abccb64e-bcb2-43fc-a571-20adc25590c4';

update "subsidy_stage_uis"
set input_ui = '{"type":"FormGroupControl","options":{"section":true,"group":true},"elements":[{"type":"Group","label":"Checklist","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/internalAssessmentChecklist","options":{"format":"checkbox-group"}}]}]},{"type":"Group","label":"Status","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/internalAssessment","options":{"format":"radio"}}]}]},{"type":"Group","label":"Toelichting","elements":[{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/internalAssessmentReasonForRejection","options":{"format":"textarea","tip":"Deze notitie wordt opgenomen binnen de brief aan de aanvrager."},"rule":{"effect":"SHOW","condition":{"scope":"#\/properties\/internalAssessment","schema":{"const":"Oneens met de eerste beoordeling"}}}}]},{"type":"VerticalLayout","elements":[{"type":"CustomControl","scope":"#\/properties\/internalAssessmentInternalNote","options":{"format":"textarea"}}]}]}]}',
    view_ui  = '{"type":"FormGroupControl","options":{"section":true},"elements":[{"type":"CustomControl","scope":"#\/properties\/internalAssessmentChecklist","options":{"readonly":true,"format":"checkbox-group"}},{"type":"CustomControl","scope":"#\/properties\/internalAssessment","options":{"readonly":true,"format":"radio"}},{"type":"CustomControl","scope":"#\/properties\/internalAssessmentInternalNote","options":{"readonly":true,"format":"textarea"}},{"type":"CustomControl","scope":"#\/properties\/internalAssessmentReasonForRejection","options":{"readonly":true,"format":"textarea"},"rule":{"effect":"SHOW","condition":{"scope":"#\/properties\/internalAssessment","schema":{"const":"Oneens met de eerste beoordeling"}}}}]}'
where id = 'b6601986-9cc0-4c03-8935-79f4e782e418';

update "subsidy_stage_transitions"
set description = 'Interne beoording oneens met eerste beoordeling',
    target_subsidy_stage_id = 'e456e790-1919-4a2b-b3d5-337d0053abe3',
    condition = '{"type":"comparison","stage":4,"fieldCode":"internalAssessment","operator":"===","value":"Oneens met de eerste beoordeling"}'
where id = '5b876216-ba37-4b13-aa99-e311db027d6b';

update "subsidy_stage_transitions"
set description = 'Interne beoordeling eens met eerste beoordeling',
    condition = '{"type":"comparison","stage":4,"fieldCode":"internalAssessment","operator":"===","value":"Eens met de eerste beoordeling"}'
where id = '5b876216-ba37-4b13-aa99-e311db027d6b';

delete from "subsidy_stage_transition_messages"
where id = '7476a2bd-15eb-4ab8-be8e-c9f3dd07f9b7';


